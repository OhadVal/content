id: Test XDR Playbook
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Test XDR Playbook
description: Cortex XDR Test Playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 9f27ef95-0aaa-41de-89ed-4e3848d2e9b5
    type: start
    task:
      id: 9f27ef95-0aaa-41de-89ed-4e3848d2e9b5
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: df040050-3d5a-4b6d-8655-a762db67fa03
    type: regular
    task:
      id: df040050-3d5a-4b6d-8655-a762db67fa03
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 11a2b980-330d-403b-82d5-97b0aec536cf
    type: regular
    task:
      id: 11a2b980-330d-403b-82d5-97b0aec536cf
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      gte_creation_time:
        simple: 2010-10-10T00:00:00
      gte_modification_time: {}
      incident_id_list: {}
      limit:
        simple: "3"
      lte_creation_time: {}
      lte_modification_time: {}
      page: {}
      since_creation_time: {}
      since_modification_time: {}
      sort_by_creation_time:
        simple: asc
      sort_by_modification_time: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 27d50179-77f4-4f7c-8f1b-fb8ad53afd0b
    type: condition
    task:
      id: 27d50179-77f4-4f7c-8f1b-fb8ad53afd0b
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.xdr_url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 1076bcca-2250-45e0-846e-d79c8afa0256
    type: regular
    task:
      id: 1076bcca-2250-45e0-846e-d79c8afa0256
      version: -1
      name: xdr-get-incident-extra-data
      description: xdr-get-incident-extra-data
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      alerts_limit: {}
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: b431d283-4fa3-490e-8410-762d07c8a5e9
    type: regular
    task:
      id: b431d283-4fa3-490e-8410-762d07c8a5e9
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      assigned_user_mail: {}
      assigned_user_pretty_name: {}
      incident_id:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
      manual_severity:
        simple: HIGH
      resolve_comment: {}
      status:
        simple: UNDER_INVESTIGATION
      unassign_user: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 8012b311-f523-474b-8483-b4e5aabe5bc7
    type: regular
    task:
      id: 8012b311-f523-474b-8483-b4e5aabe5bc7
      version: -1
      name: xdr-insert-parsed-alert
      description: xdr-insert-parsed-alert
      script: '|||xdr-insert-parsed-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      alert_description:
        simple: This alert from content  TestXDRPlaybook description
      alert_name:
        simple: This alert from content  TestXDRPlaybook
      event_timestamp: {}
      local_ip:
        simple: 196.168.0.111
      local_port:
        simple: "2000"
      product:
        simple: SandBlast
      remote_ip:
        simple: 2.2.2.2
      remote_port:
        simple: "6000"
      severity:
        simple: High
      vendor:
        simple: Checkpoint
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: 1566b0ec-84fb-4dcc-821d-d3aaf242a04b
    type: regular
    task:
      id: 1566b0ec-84fb-4dcc-821d-d3aaf242a04b
      version: -1
      name: xdr-insert-cef-alerts
      description: xdr-insert-cef-alerts
      script: '|||xdr-insert-cef-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      cef_alerts:
        simple: ${cef_alerts}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 7422c03e-decc-4d70-854c-be0ea1c0b675
    type: regular
    task:
      id: 7422c03e-decc-4d70-854c-be0ea1c0b675
      version: -1
      name: xdr-isolate-endpoint
      description: xdr-isolate-endpoint
      script: '|||xdr-isolate-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: c16c649e-4bef-45bf-830f-34d2463fc373
    type: regular
    task:
      id: c16c649e-4bef-45bf-830f-34d2463fc373
      version: -1
      name: xdr-unisolate-endpoint
      description: xdr-unisolate-endpoint
      script: '|||xdr-unisolate-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: ce320e45-0112-462a-8d1a-10be705fd546
    type: regular
    task:
      id: ce320e45-0112-462a-8d1a-10be705fd546
      version: -1
      name: xdr-get-endpoints
      description: xdr-get-endpoints
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
      - "73"
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list: {}
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname:
        simple: ip-172-31-15-237.eu-central-1.compute.internal
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 5d01f811-6c37-4d30-8ae7-e5fb08792202
    type: condition
    task:
      id: 5d01f811-6c37-4d30-8ae7-e5fb08792202
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.os_type
            iscontext: true
          right:
            value:
              simple: AGENT_OS_LINUX
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.ip
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: a06e4e9c-f37a-4f55-871c-21ce1d8faca8
    type: regular
    task:
      id: a06e4e9c-f37a-4f55-871c-21ce1d8faca8
      version: -1
      name: xdr-get-distribution-versions
      description: xdr-get-distribution-versions
      script: '|||xdr-get-distribution-versions'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 483c84a0-a763-4052-841e-4f186e18a4c3
    type: condition
    task:
      id: 483c84a0-a763-4052-841e-4f186e18a4c3
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.windows
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.linux
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: f857ec52-96f8-486f-8804-bbd42e015022
    type: regular
    task:
      id: f857ec52-96f8-486f-8804-bbd42e015022
      version: -1
      name: xdr-create-distribution
      description: xdr-create-distribution
      script: '|||xdr-create-distribution'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      agent_version:
        complex:
          root: PaloAltoNetworksXDR
          accessor: DistributionVersions.linux
          transformers:
          - operator: FirstArrayElement
      description:
        simple: Created by TestXDRPlaybook
      name:
        simple: This is test distribution
      package_type:
        simple: standalone
      platform:
        simple: linux
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: a9c56cea-3e52-41ac-82d4-8037c69e22ed
    type: condition
    task:
      id: a9c56cea-3e52-41ac-82d4-8037c69e22ed
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.platform
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: d025b50d-f5ec-49c3-8357-b89af9dd44ff
    type: regular
    task:
      id: d025b50d-f5ec-49c3-8357-b89af9dd44ff
      version: -1
      name: xdr-get-distribution-url
      description: xdr-get-distribution-url
      script: '|||xdr-get-distribution-url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      distribution_id:
        simple: 2c74c11b63074653aa01d575a82bf52a
      package_type:
        simple: sh
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 19c0ae89-d417-4ed8-8df1-2ada1ba01a31
    type: condition
    task:
      id: 19c0ae89-d417-4ed8-8df1-2ada1ba01a31
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.url
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5065
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: f3e60080-3a92-4e1c-8d6d-81cb1a9f9ba0
    type: regular
    task:
      id: f3e60080-3a92-4e1c-8d6d-81cb1a9f9ba0
      version: -1
      name: xdr-get-create-distribution-status
      description: xdr-get-create-distribution-status
      script: '|||xdr-get-create-distribution-status'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      distribution_ids:
        simple: ${PaloAltoNetworksXDR.Distribution.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: fa396b2f-1917-427a-80aa-a0516d63b1b6
    type: condition
    task:
      id: fa396b2f-1917-427a-80aa-a0516d63b1b6
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: Completed
        - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: In Progress
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 8340fe16-9de0-4cff-875a-acc3fa625484
    type: regular
    task:
      id: 8340fe16-9de0-4cff-875a-acc3fa625484
      version: -1
      name: xdr-get-audit-management-logs
      description: xdr-get-audit-management-logs
      script: '|||xdr-get-audit-management-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      email: {}
      limit:
        simple: "5"
      page: {}
      result: {}
      sort_by:
        simple: sub_type
      sort_order:
        simple: asc
      sub_type:
        simple: Authentication failed
      timestamp_gte:
        simple: "0"
      timestamp_lte: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: 32fc4936-ec0d-4e29-8918-7717dea839b7
    type: condition
    task:
      id: 32fc4936-ec0d-4e29-8918-7717dea839b7
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
            iscontext: true
          right:
            value:
              simple: Authentication failed
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 9bf8867a-e9f5-4169-8630-f9f952c946bb
    type: regular
    task:
      id: 9bf8867a-e9f5-4169-8630-f9f952c946bb
      version: -1
      name: xdr-get-audit-agent-reports
      description: xdr-get-audit-agent-reports
      script: '|||xdr-get-audit-agent-reports'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      endpoint_ids: {}
      endpoint_names:
        simple: ip-172-31-15-237.eu-central-1.compute.internal
      limit:
        simple: "5"
      page: {}
      result:
        simple: Success
      retry-count:
        simple: "3"
      retry-interval:
        simple: "30"
      sort_by:
        simple: category
      sort_order:
        simple: desc
      sub_type: {}
      timestamp_gte:
        simple: "2019-10-10"
      timestamp_lte: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "24":
    id: "24"
    taskid: 3da4f299-ea91-4e10-843a-8fd3dabbc9ca
    type: condition
    task:
      id: 3da4f299-ea91-4e10-843a-8fd3dabbc9ca
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
            iscontext: true
          right:
            value:
              simple: ip-172-31-15-237.eu-central-1.compute.internal
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Endpoint.ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: 9bc3e51e-9f2a-43a8-858a-ad1db6ddc853
    type: title
    task:
      id: 9bc3e51e-9f2a-43a8-858a-ad1db6ddc853
      version: -1
      name: Test Done
      description: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 10140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: 6471f1ce-1e35-4cc1-8fc9-56ab8e312225
    type: condition
    task:
      id: 6471f1ce-1e35-4cc1-8fc9-56ab8e312225
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.manual_severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.xdr_url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.alerts.alert_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.alerts.source
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.network_artifacts.network_remote_ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 2e529b80-baf0-4c6b-8a0e-46043836ad44
    type: regular
    task:
      id: 2e529b80-baf0-4c6b-8a0e-46043836ad44
      version: -1
      name: Save incident id
      description: Save incident id
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      append: {}
      key:
        simple: XDRIncidentID
      value:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: 95535349-b125-4251-840f-f9b37581ef86
    type: regular
    task:
      id: 95535349-b125-4251-840f-f9b37581ef86
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep:
        simple: XDRIncidentID
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: 28084882-8c4f-469a-8fc0-7b2c061e7fdf
    type: regular
    task:
      id: 28084882-8c4f-469a-8fc0-7b2c061e7fdf
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      gte_creation_time: {}
      gte_modification_time: {}
      incident_id_list:
        simple: ${XDRIncidentID}
      limit: {}
      lte_creation_time: {}
      lte_modification_time: {}
      page: {}
      since_creation_time: {}
      since_modification_time: {}
      sort_by_creation_time:
        simple: desc
      sort_by_modification_time: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 11bc8d28-5869-4ad5-8398-818da0e3bcc5
    type: condition
    task:
      id: 11bc8d28-5869-4ad5-8398-818da0e3bcc5
      version: -1
      name: Verify updated values
      description: Verify updated values
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
          right:
            value:
              simple: high
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
          right:
            value:
              simple: under_investigation
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: 8a3fd18c-2e03-4079-8839-3105de1c98a5
    type: regular
    task:
      id: 8a3fd18c-2e03-4079-8839-3105de1c98a5
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      assigned_user_mail: {}
      assigned_user_pretty_name: {}
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
      manual_severity:
        simple: LOW
      resolve_comment: {}
      status:
        simple: NEW
      unassign_user: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 8d18cff3-c185-428f-873c-f473b48ef202
    type: regular
    task:
      id: 8d18cff3-c185-428f-873c-f473b48ef202
      version: -1
      name: Set 2 CEF alerts to context
      description: Set 2 CEF alerts to context
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: cef_alerts
      value:
        simple: |-
          [
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|microsoft-ds|Unknown|act=AcceptdeviceDirection=0 rt=1569477512000 spt=56957 dpt=445 cs2Label=Rule Name cs2=ADPrimery layer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=1806 parent_rule=0rule_action=Accept rule_uid=8e45f36b-d106-4d81-a1f0-9d1ed9a6be5c ifname=bond2logid=0 loguid={0x5d8c5388,0x61,0x29321fac,0xc0000022} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=363 version=5dst=1.1.1.1 inzone=External outzone=Internal product=VPN-1 & FireWall-1 proto=6service_id=microsoft-ds src=1.1.1.1",
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|Log|Unknown|act=AcceptdeviceDirection=0 rt=1569477501000 spt=63088 dpt=5985 cs2Label=Rule Namelayer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=8899 parent_rule=0rule_action=Accept rule_uid=ae987933-82c0-470f-ab1c-1ad552c82369conn_direction=Internal ifname=bond1.12 logid=0loguid={0x5d8c537d,0xbb,0x29321fac,0xc0000014} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=899 version=5dst=1.1.1.1 product=VPN-1 & FireWall-1 proto=6 src=1.1.1.1"
                  ]
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: db448fdd-72e2-48a4-8495-a655eeb6ed96
    type: regular
    task:
      id: db448fdd-72e2-48a4-8495-a655eeb6ed96
      version: -1
      name: Get Endpoint f8a2f58846b542579c12090652e79f3d
      description: Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields will be concatenated using AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of endpoint
        from the start of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list:
        simple: f8a2f58846b542579c12090652e79f3d
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: a4ac6a67-a380-43d2-8ad4-f86a4e1b2573
    type: condition
    task:
      id: a4ac6a67-a380-43d2-8ad4-f86a4e1b2573
      version: -1
      name: To isolate ?
      description: To isolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_UNISOLATED
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: f83fcf9e-ec06-4714-8a99-c2ce67f3e603
    type: condition
    task:
      id: f83fcf9e-ec06-4714-8a99-c2ce67f3e603
      version: -1
      name: To unisolate?
      description: To unisolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_ISOLATED
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 8a91888b-c4c5-47db-811a-65b0d4bc6eef
    type: title
    task:
      id: 8a91888b-c4c5-47db-811a-65b0d4bc6eef
      version: -1
      name: Isolation done
      description: Isolation done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 38076122-631a-4431-8d9d-6415638cdf3d
    type: regular
    task:
      id: 38076122-631a-4431-8d9d-6415638cdf3d
      version: -1
      name: xdr-get-endpoints
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list: {}
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: 5135ee39-fead-43b4-8ad4-b80c156f51cf
    type: condition
    task:
      id: 5135ee39-fead-43b4-8ad4-b80c156f51cf
      version: -1
      name: Check the number of endpoints in context
      description: Check the number of endpoints in context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Endpoint
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: 4d711f4a-30ff-4973-87a8-081bc03f7ca8
    type: playbook
    task:
      id: 4d711f4a-30ff-4973-87a8-081bc03f7ca8
      version: -1
      name: Cortex XDR - quarantine file
      description: Cortex XDR - quarantine file
      playbookName: Cortex XDR - quarantine file
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      endpoint_id:
        simple: ea303670c76e4ad09600c8b346f7c804
      file_hash:
        simple: 55f8718109829bf506b09d8af615b9f107a266e19f7a311039d1035f180b22d4
      file_path:
        simple: /home/ec2-user/test_file.txt
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "40":
    id: "40"
    taskid: 2708891c-acc1-4e94-8dbc-976a141b5f98
    type: regular
    task:
      id: 2708891c-acc1-4e94-8dbc-976a141b5f98
      version: -1
      name: xdr-get-policy
      description: Gets the policy name for a specific endpoint.
      script: '|||xdr-get-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      endpoint_id:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          accessor: endpoint_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: 44ce3d20-2202-4a27-83cf-273133c99f0e
    type: condition
    task:
      id: 44ce3d20-2202-4a27-83cf-273133c99f0e
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Policy.policy_name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "42":
    id: "42"
    taskid: 279a0b7f-7ead-4319-85ce-1210f237f3d1
    type: regular
    task:
      id: 279a0b7f-7ead-4319-85ce-1210f237f3d1
      version: -1
      name: xdr-get-endpoint-device-control-violations
      description: Gets a list of device control violations filtered by selected fields.
        You can retrieve up to 100 violations.
      script: '|||xdr-get-endpoint-device-control-violations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      endpoint_ids: {}
      hostname: {}
      ip_list: {}
      product: {}
      product_id: {}
      serial: {}
      timestamp_gte: {}
      timestamp_lte: {}
      type: {}
      username: {}
      vendor: {}
      vendor_id: {}
      violation_id_list: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "43":
    id: "43"
    taskid: 575dbbc4-38cd-4b22-83bf-408c794a0c09
    type: condition
    task:
      id: 575dbbc4-38cd-4b22-83bf-408c794a0c09
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.EndpointViolations
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "48":
    id: "48"
    taskid: 1968cd9c-5cdc-4171-825a-b015af8cc950
    type: regular
    task:
      id: 1968cd9c-5cdc-4171-825a-b015af8cc950
      version: -1
      name: xdr-get-scripts
      description: Gets a list of scripts available in the scripts library.
      script: '|||xdr-get-scripts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      created_by: {}
      description: {}
      is_high_risk: {}
      limit: {}
      linux_supported: {}
      macos_supported: {}
      offset: {}
      script_name: {}
      windows_supported: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "49":
    id: "49"
    taskid: 7aa6345b-0b8d-4504-8cbf-670a04f6a958
    type: condition
    task:
      id: 7aa6345b-0b8d-4504-8cbf-670a04f6a958
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Scripts
                accessor: script_uid
                transformers:
                - operator: FirstArrayElement
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "50":
    id: "50"
    taskid: 46da6019-af92-407a-8d52-b70582307aae
    type: regular
    task:
      id: 46da6019-af92-407a-8d52-b70582307aae
      version: -1
      name: xdr-get-script-metadata
      description: Gets the full definition of a specific script in the scripts library.
      script: '|||xdr-get-script-metadata'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "51":
    id: "51"
    taskid: 75f0673b-016f-45f1-8f0c-40b28f1f5a64
    type: condition
    task:
      id: 75f0673b-016f-45f1-8f0c-40b28f1f5a64
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptMetadata
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "58":
    id: "58"
    taskid: 56e213c2-e953-4e3a-8268-c2d25aed5033
    type: regular
    task:
      id: 56e213c2-e953-4e3a-8268-c2d25aed5033
      version: -1
      name: xdr-get-script-code
      description: Gets the code of a specific script in the script library.
      script: '|||xdr-get-script-code'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "59":
    id: "59"
    taskid: bdf80cf7-3524-4fca-8c10-b0964cbb1cdc
    type: condition
    task:
      id: bdf80cf7-3524-4fca-8c10-b0964cbb1cdc
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptCode
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "60":
    id: "60"
    taskid: d7392fc0-8d77-4851-8dae-9453dd0d0c0f
    type: playbook
    task:
      id: d7392fc0-8d77-4851-8dae-9453dd0d0c0f
      version: -1
      name: Cortex XDR - Retrieve File Playbook
      description: |-
        Retrieves files from selected endpoints. You can retrieve up to 20 files, from no more than 10 endpoints.
        Inputs for this playbook are:
        - A comma-separated list of endpoint IDs.
        - A comma-separated list of file paths for your operating system, either Windows, Linux, or Mac. At least one file path is required.
      playbookName: Cortex XDR - Retrieve File Playbook
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      endpoint_ids:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      linux_file_paths: {}
      mac_file_paths: {}
      windows_file_paths:
        simple: C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: bccfdfcd-e25d-475a-86f9-3e9178289192
    type: regular
    task:
      id: bccfdfcd-e25d-475a-86f9-3e9178289192
      version: -1
      name: xdr-retrieve-files
      description: Retrieves files from selected endpoints. You can retrieve up to
        20 files, from no more than 10 endpoints. At least one endpoint ID and one
        file path are necessary in order to run the command. After running this command,
        you can use the xdr-action-status-get command with returned action_id, to
        check the action status.
      script: '|||xdr-retrieve-files'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.agent_status
                iscontext: true
              right:
                value:
                  simple: CONNECTED
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.agent_type
                iscontext: true
              right:
                value:
                  simple: Workstation
          accessor: endpoint_id
      linux_file_paths: {}
      mac_file_paths: {}
      windows_file_paths:
        simple: C:\Users\demisto\Desktop\demisto.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 8215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: 0f9d1fe0-e439-49e3-8baa-8b19a2ba99ed
    type: playbook
    task:
      id: 0f9d1fe0-e439-49e3-8baa-8b19a2ba99ed
      version: -1
      name: Cortex XDR - Check Action Status
      description: Checks the action status of an action ID. \nEnter the action ID
        of the action whose status you want to know.
      playbookName: Cortex XDR - Check Action Status
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      action_id:
        simple: ${PaloAltoNetworksXDR.RetrievedFiles.action_id}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 8390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "63":
    id: "63"
    taskid: 36f47b33-ec17-4368-883c-6999e305f437
    type: condition
    task:
      id: 36f47b33-ec17-4368-883c-6999e305f437
      version: -1
      name: Verify retrieve file
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: ca24d08f-6c60-45f0-8d43-9673c1dcf06c
    type: condition
    task:
      id: ca24d08f-6c60-45f0-8d43-9673c1dcf06c
      version: -1
      name: Verify check action status
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.GetActionStatus.status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 8565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: ed44ca72-8755-4f13-8167-60249c9dbba6
    type: regular
    task:
      id: ed44ca72-8755-4f13-8167-60249c9dbba6
      version: -1
      name: Run Script
      description: Initiate a new endpoint script execution action using a script
        from the script library.
      script: '|||xdr-run-script'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.host_name
                iscontext: true
              right:
                value:
                  simple: WIN10X64
          accessor: endpoint_id
      parameters:
        simple: '{"commands_list":["echo hi"]}'
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Scripts.name
                iscontext: true
              right:
                value:
                  simple: execute_commands
          accessor: script_uid
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: b5b4dac2-b484-4e7d-8868-c123232a10f4
    type: regular
    task:
      id: b5b4dac2-b484-4e7d-8868-c123232a10f4
      version: -1
      name: Get Script Execution Status
      description: Retrieve the status of a script execution action.
      script: '|||xdr-get-script-execution-status'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      action_id:
        simple: ${PaloAltoNetworksXDR.ScriptRun.action_id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: 29683505-adfe-46cc-8133-a3de6c8927b7
    type: condition
    task:
      id: 29683505-adfe-46cc-8133-a3de6c8927b7
      version: -1
      name: Verify Execution Status Is Pending
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptStatus.general_status
            iscontext: true
          right:
            value:
              simple: PENDING
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "68":
    id: "68"
    taskid: b789d8f5-de7e-489c-897f-c8497dec763a
    type: regular
    task:
      id: b789d8f5-de7e-489c-897f-c8497dec763a
      version: -1
      name: Get Script Results
      description: Retrieve the results of a script execution action.
      script: '|||xdr-get-script-execution-results'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      action_id:
        simple: ${PaloAltoNetworksXDR.ScriptRun.action_id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: c9ae72e5-6cba-4dff-807d-3badee4afce7
    type: condition
    task:
      id: c9ae72e5-6cba-4dff-807d-3badee4afce7
      version: -1
      name: Verify Execution Status Is Pending
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "70"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptResult.results.execution_status
            iscontext: true
          right:
            value:
              simple: PENDING
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "70":
    id: "70"
    taskid: 6b0b7ac6-6eb3-4015-83bc-58d1b6e7b8c8
    type: regular
    task:
      id: 6b0b7ac6-6eb3-4015-83bc-58d1b6e7b8c8
      version: -1
      name: Run snippet code script
      description: Initiate a new endpoint script execution action using provided
        snippet code.
      script: '|||xdr-run-snippet-code-script'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.host_name
                iscontext: true
              right:
                value:
                  simple: WIN10X64
          accessor: endpoint_id
      snippet_code:
        simple: print("hello world")
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "71":
    id: "71"
    taskid: 79de4e54-e5fa-4fc8-8924-54959e11b38f
    type: regular
    task:
      id: 79de4e54-e5fa-4fc8-8924-54959e11b38f
      version: -1
      name: Run script execute commands
      description: Initiate a new endpoint script execution of shell commands.
      script: '|||xdr-run-script-execute-commands'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      commands:
        simple: tasklist
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.host_name
                iscontext: true
              right:
                value:
                  simple: WIN10X64
          accessor: endpoint_id
      timeout:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "72":
    id: "72"
    taskid: 44307814-96c6-4509-81da-242680da63f0
    type: regular
    task:
      id: 44307814-96c6-4509-81da-242680da63f0
      version: -1
      name: Run Script With Empty Params
      description: Initiate a new endpoint script execution action using a script
        from the script library.
      script: '|||xdr-run-script'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.host_name
                iscontext: true
              right:
                value:
                  simple: WIN10X64
          accessor: endpoint_id
      parameters:
        simple: ${inputs.parameters}
      script_uid:
        simple: dc5815bb786f4cc095671f3150717fc8
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "73":
    id: "73"
    taskid: 7b5160ca-789c-4d28-8ae7-da6f078b8337
    type: regular
    task:
      id: 7b5160ca-789c-4d28-8ae7-da6f078b8337
      version: -1
      name: xdr-endpoint-scan
      description: Runs a scan on a selected endpoint. To scan all endpoints, run
        this command with no filters.
      script: '|||xdr-endpoint-scan'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "74"
    scriptarguments:
      alias: {}
      all: {}
      dist_name: {}
      endpoint_id_list:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          accessor: endpoint_id
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      group_name: {}
      gte_first_seen: {}
      gte_last_seen: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      lte_first_seen: {}
      lte_last_seen: {}
      platform: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 80,
          "y": 3600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "74":
    id: "74"
    taskid: 3f55ce12-a6eb-4393-8f21-bd9273b89cf0
    type: condition
    task:
      id: 3f55ce12-a6eb-4393-8f21-bd9273b89cf0
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "75"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.endpointScan.actionId
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.endpointScan.aborted
            iscontext: true
          right:
            value:
              simple: "false"
    view: |-
      {
        "position": {
          "x": 80,
          "y": 3775
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "75":
    id: "75"
    taskid: 756ca0a2-8509-42a2-8973-121d222eaf3b
    type: regular
    task:
      id: 756ca0a2-8509-42a2-8973-121d222eaf3b
      version: -1
      name: xdr-endpoint-scan-abort
      description: Cancel the scan of selected endpoints. A scan can only be aborted
        if the selected endpoints are in Pending or in Progress status. To scan all
        endpoints, run this command with argument all=true. Do note that scanning
        all the endpoints may cause performance issues and latency.
      script: '|||xdr-endpoint-scan-abort'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      alias: {}
      all: {}
      dist_name: {}
      endpoint_id_list:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          accessor: endpoint_id
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      group_name: {}
      gte_first_seen: {}
      gte_last_seen: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      lte_first_seen: {}
      lte_last_seen: {}
      platform: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "76":
    id: "76"
    taskid: d3718720-547c-4af7-8b81-91f44fd10a05
    type: condition
    task:
      id: d3718720-547c-4af7-8b81-91f44fd10a05
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.endpointScan
                accessor: actionId
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "1"
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.endpointScan
                accessor: aborted
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "1"
            iscontext: true
          right:
            value:
              simple: "true"
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10155,
        "width": 922.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: parameters
  value: {}
  required: false
  description: ""
  playbookInputQuery: null
outputs: []
fromversion: 5.0.0